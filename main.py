import telebot
from telebot import types
from gtts import gTTS
import os
import sqlite3
from threading import Lock, Thread
import time
from dotenv import load_dotenv  # Ğ‘Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ° Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñ‹

# --- Ğ˜ĞĞ˜Ğ¦Ğ˜ĞĞ›Ğ˜Ğ—ĞĞ¦Ğ˜Ğ¯ Ğ—ĞĞ©Ğ˜Ğ¢Ğ« ---
load_dotenv()  # Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ· Ñ„Ğ°Ğ¹Ğ»Ğ° .env

TOKEN = os.getenv("BOT_TOKEN")
ADMIN_ID = int(os.getenv("ADMIN_ID")) if os.getenv("ADMIN_ID") else 0
ADMIN_NICK = "@Dbebrreuf"

if not TOKEN:
    print("âŒ ĞĞ¨Ğ˜Ğ‘ĞšĞ: Ğ¢Ğ¾ĞºĞµĞ½ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½ Ğ² .env Ñ„Ğ°Ğ¹Ğ»Ğµ!")
    exit()

bot = telebot.TeleBot(TOKEN, threaded=True, num_threads=200)

db_lock = Lock()
user_data = {} 

if not os.path.exists('voice_cache'):
    os.makedirs('voice_cache')

# --- Ğ‘Ğ” ---
def init_db():
    with db_lock:
        conn = sqlite3.connect('gym_pro_users.db', check_same_thread=False)
        cursor = conn.cursor()
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS users (
                user_id INTEGER PRIMARY KEY,
                username TEXT,
                first_name TEXT,
                is_premium INTEGER DEFAULT 0,
                join_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        conn.commit()
        return conn, cursor

conn, cursor = init_db()

# --- Ğ‘ĞĞ—Ğ Ğ£ĞŸĞ ĞĞ–ĞĞ•ĞĞ˜Ğ™ (Ğ‘Ğ•Ğ¡ĞŸĞ›ĞĞ¢ĞĞ«Ğ•) ---
WORKOUTS = {
    "Ğ’Ğ•Ğ Ğ¥ Ğ¢Ğ•Ğ›Ğ": [
        {"name": "ĞšĞ»Ğ°ÑÑĞ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ", "reps": "3 x 15", "desc": "Ğ“Ñ€ÑƒĞ´ÑŒ Ğ¿Ğ¾Ñ‡Ñ‚Ğ¸ ĞºĞ°ÑĞ°ĞµÑ‚ÑÑ Ğ¿Ğ¾Ğ»Ğ°, Ñ‚ĞµĞ»Ğ¾ Ñ€Ğ¾Ğ²Ğ½Ğ¾Ğµ."},
        {"name": "ĞĞ±Ñ€Ğ°Ñ‚Ğ½Ñ‹Ğµ Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ", "reps": "3 x 12", "desc": "Ğ ÑƒĞºĞ¸ Ğ½Ğ° Ğ¾Ğ¿Ğ¾Ñ€Ğµ ÑĞ·Ğ°Ğ´Ğ¸, Ğ»Ğ¾ĞºÑ‚Ğ¸ Ğ½Ğ°Ğ·Ğ°Ğ´."},
        {"name": "Ğ¨Ğ¸Ñ€Ğ¾ĞºĞ¸Ğµ Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ", "reps": "3 x 12", "desc": "Ğ ÑƒĞºĞ¸ ÑˆĞ¸Ñ€Ğµ Ğ¿Ğ»ĞµÑ‡ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ³Ñ€ÑƒĞ´Ğ¸."},
        {"name": "ĞĞ»Ğ¼Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ", "reps": "3 x 10", "desc": "Ğ›Ğ°Ğ´Ğ¾Ğ½Ğ¸ Ğ±Ğ»Ğ¸Ğ·ĞºĞ¾, Ğ¾Ğ±Ñ€Ğ°Ğ·ÑƒÑÑ‚ Ñ€Ğ¾Ğ¼Ğ±."},
        {"name": "ĞŸĞ»Ğ°Ğ½ĞºĞ° Ğ½Ğ° Ğ»Ğ¾ĞºÑ‚ÑÑ…", "reps": "3 x 45 ÑĞµĞº", "desc": "ĞšĞ»Ğ°ÑÑĞ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¿Ğ»Ğ°Ğ½ĞºĞ°."}
    ],
    "ĞĞĞ“Ğ˜ Ğ˜ Ğ¯Ğ“ĞĞ”Ğ˜Ğ¦Ğ«": [
        {"name": "ĞŸÑ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ñ", "reps": "4 x 20", "desc": "ĞŸÑÑ‚ĞºĞ¸ Ğ½Ğ° Ğ¿Ğ¾Ğ»Ñƒ, Ñ‚Ğ°Ğ· Ğ½Ğ°Ğ·Ğ°Ğ´."},
        {"name": "ĞšĞ»Ğ°ÑÑĞ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ²Ñ‹Ğ¿Ğ°Ğ´Ñ‹", "reps": "3 x 12", "desc": "ĞšĞ¾Ğ»ĞµĞ½Ğ¾ ÑĞ·Ğ°Ğ´Ğ¸ Ğ¿Ğ¾Ñ‡Ñ‚Ğ¸ Ğ´Ğ¾ Ğ¿Ğ¾Ğ»Ğ°."},
        {"name": "Ğ‘Ğ¾ĞºĞ¾Ğ²Ñ‹Ğµ Ğ²Ñ‹Ğ¿Ğ°Ğ´Ñ‹", "reps": "3 x 15", "desc": "Ğ¨Ğ°Ğ³ Ğ² ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ñƒ, ÑĞ¿Ğ¸Ğ½Ğ° Ğ¿Ñ€ÑĞ¼Ğ°Ñ."},
        {"name": "Ğ¯Ğ³Ğ¾Ğ´Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ¼Ğ¾ÑÑ‚Ğ¸Ğº", "reps": "3 x 20", "desc": "Ğ’Ñ‹Ñ‚Ğ°Ğ»ĞºĞ¸Ğ²Ğ°ĞµĞ¼ Ñ‚Ğ°Ğ· Ğ²Ğ²ĞµÑ€Ñ…."},
        {"name": "ĞŸĞ¾Ğ´ÑŠĞµĞ¼Ñ‹ Ğ½Ğ° Ğ½Ğ¾ÑĞºĞ¸", "reps": "3 x 25", "desc": "ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ´ÑŠĞµĞ¼ Ğ²Ğ²ĞµÑ€Ñ…."}
    ]
}

# --- ĞŸĞ Ğ ĞŸĞ˜Ğ¢ĞĞĞ˜Ğ• (30 Ğ”ĞĞ•Ğ™) ---
PRO_DIET = {
    1: "ğŸ Ğ”ĞµĞ½ÑŒ 1: ĞĞ²ÑÑĞ½ĞºĞ° + ÑĞ¹Ñ†Ğ°. ĞĞ±ĞµĞ´: ĞšÑƒÑ€Ğ¸Ñ†Ğ° + Ğ“Ñ€ĞµÑ‡ĞºĞ°. Ğ£Ğ¶Ğ¸Ğ½: Ğ¢Ğ²Ğ¾Ñ€Ğ¾Ğ³.",
    2: "ğŸ Ğ”ĞµĞ½ÑŒ 2: ĞĞ¼Ğ»ĞµÑ‚. ĞĞ±ĞµĞ´: Ğ Ñ‹Ğ±Ğ° + Ğ Ğ¸Ñ. Ğ£Ğ¶Ğ¸Ğ½: Ğ¡Ğ°Ğ»Ğ°Ñ‚ Ñ Ñ‚ÑƒĞ½Ñ†Ğ¾Ğ¼.",
    3: "ğŸ Ğ”ĞµĞ½ÑŒ 3: Ğ¡Ñ‹Ñ€Ğ½Ğ¸ĞºĞ¸. ĞĞ±ĞµĞ´: Ğ˜Ğ½Ğ´ĞµĞ¹ĞºĞ° + Ğ‘ÑƒĞ»Ğ³ÑƒÑ€. Ğ£Ğ¶Ğ¸Ğ½: ĞšĞµÑ„Ğ¸Ñ€.",
    4: "ğŸ Ğ”ĞµĞ½ÑŒ 4: Ğ¢Ğ¾ÑÑ‚ Ñ Ğ°Ğ²Ğ¾ĞºĞ°Ğ´Ğ¾. ĞĞ±ĞµĞ´: Ğ“Ğ¾Ğ²ÑĞ´Ğ¸Ğ½Ğ° + ĞœĞ°ĞºĞ°Ñ€Ğ¾Ğ½Ñ‹. Ğ£Ğ¶Ğ¸Ğ½: ĞĞ¼Ğ»ĞµÑ‚.",
    5: "ğŸ Ğ”ĞµĞ½ÑŒ 5: Ğ“Ñ€ĞµÑ‡ĞºĞ° Ñ Ğ¼Ğ¾Ğ»Ğ¾ĞºĞ¾Ğ¼. ĞĞ±ĞµĞ´: ĞšĞ¾Ñ‚Ğ»ĞµÑ‚Ñ‹ + ĞšĞ¸Ğ½Ğ¾Ğ°. Ğ£Ğ¶Ğ¸Ğ½: Ğ¢Ğ²Ğ¾Ñ€Ğ¾Ğ³.",
    6: "ğŸ Ğ”ĞµĞ½ÑŒ 6: Ğ¢Ğ²Ğ¾Ñ€Ğ¾Ğ¶Ğ½Ğ°Ñ Ğ·Ğ°Ğ¿ĞµĞºĞ°Ğ½ĞºĞ°. ĞĞ±ĞµĞ´: Ğ“Ğ¾Ñ€Ğ±ÑƒÑˆĞ° + ĞĞ²Ğ¾Ñ‰Ğ¸. Ğ£Ğ¶Ğ¸Ğ½: Ğ ÑĞ¶ĞµĞ½ĞºĞ°.",
    7: "ğŸ Ğ”ĞµĞ½ÑŒ 7: Ğ¯Ğ¸Ñ‡Ğ½Ğ¸Ñ†Ğ°. ĞĞ±ĞµĞ´: ĞšÑƒÑ€Ğ¸Ğ½Ñ‹Ğ¹ ÑÑƒĞ¿. Ğ£Ğ¶Ğ¸Ğ½: Ğ Ñ‹Ğ±Ğ° Ğ½Ğ° Ğ¿Ğ°Ñ€Ñƒ.",
    8: "ğŸ Ğ”ĞµĞ½ÑŒ 8: Ğ™Ğ¾Ğ³ÑƒÑ€Ñ‚ + Ğ‘Ğ°Ğ½Ğ°Ğ½. ĞĞ±ĞµĞ´: ĞŸĞ»Ğ¾Ğ² Ñ Ğ¸Ğ½Ğ´ĞµĞ¹ĞºĞ¾Ğ¹. Ğ£Ğ¶Ğ¸Ğ½: Ğ¡Ğ°Ğ»Ğ°Ñ‚.",
    9: "ğŸ Ğ”ĞµĞ½ÑŒ 9: ĞœÑÑĞ»Ğ¸. ĞĞ±ĞµĞ´: Ğ¢ĞµĞ»ÑÑ‚Ğ¸Ğ½Ğ° + Ğ“Ñ€ĞµÑ‡ĞºĞ°. Ğ£Ğ¶Ğ¸Ğ½: Ğ¯Ğ¹Ñ†Ğ°.",
    10: "ğŸ Ğ”ĞµĞ½ÑŒ 10: ĞšĞ°ÑˆĞ° Ğ¿ÑˆĞµĞ½Ğ½Ğ°Ñ. ĞĞ±ĞµĞ´: Ğ—Ğ°Ğ¿ĞµÑ‡ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¼Ğ¸Ğ½Ñ‚Ğ°Ğ¹. Ğ£Ğ¶Ğ¸Ğ½: Ğ¢Ğ²Ğ¾Ñ€Ğ¾Ğ³.",
    11: "ğŸ Ğ”ĞµĞ½ÑŒ 11: Ğ¢Ğ¾ÑÑ‚ Ñ ÑÑ‹Ñ€Ğ¾Ğ¼. ĞĞ±ĞµĞ´: Ğ›Ğ°Ğ¿ÑˆĞ° ĞºÑƒÑ€Ğ¸Ğ½Ğ°Ñ. Ğ£Ğ¶Ğ¸Ğ½: ĞĞ²Ğ¾Ñ‰Ğ¸.",
    12: "ğŸ Ğ”ĞµĞ½ÑŒ 12: Ğ‘Ğ»Ğ¸Ğ½Ñ‹ Ğ¾Ğ²ÑÑĞ½Ñ‹Ğµ. ĞĞ±ĞµĞ´: Ğ˜Ğ½Ğ´ĞµĞ¹ĞºĞ° Ğ² Ğ´ÑƒÑ…Ğ¾Ğ²ĞºĞµ. Ğ£Ğ¶Ğ¸Ğ½: Ğ“Ñ€ÑƒĞ´ĞºĞ°.",
    13: "ğŸ Ğ”ĞµĞ½ÑŒ 13: ĞĞ¼Ğ»ĞµÑ‚ Ğ±ĞµĞ»ĞºĞ¾Ğ²Ñ‹Ğ¹. ĞĞ±ĞµĞ´: Ğ›Ğ°Ğ·Ğ°Ğ½ÑŒÑ ĞŸĞŸ. Ğ£Ğ¶Ğ¸Ğ½: Ğ¢Ğ²Ğ¾Ñ€Ğ¾Ğ³.",
    14: "ğŸ Ğ”ĞµĞ½ÑŒ 14: Ğ¢Ğ²Ğ¾Ñ€Ğ¾Ğ³ + Ğ¾Ñ€ĞµÑ…Ğ¸. ĞĞ±ĞµĞ´: ĞšÑƒÑ€Ğ¸Ñ†Ğ° Ğ¢ĞµÑ€Ğ¸ÑĞºĞ¸. Ğ£Ğ¶Ğ¸Ğ½: ĞšĞµÑ„Ğ¸Ñ€.",
    15: "ğŸ Ğ”ĞµĞ½ÑŒ 15: Ğ¡Ğ¼ÑƒĞ·Ğ¸ Ñ„Ñ€ÑƒĞºÑ‚Ğ¾Ğ²Ñ‹Ğ¹. ĞĞ±ĞµĞ´: Ğ¡Ñ‚ĞµĞ¹Ğº Ğ³Ğ¾Ğ²ÑĞ¶Ğ¸Ğ¹. Ğ£Ğ¶Ğ¸Ğ½: Ğ¡Ğ°Ğ»Ğ°Ñ‚.",
    16: "ğŸ Ğ”ĞµĞ½ÑŒ 16: Ğ¢Ğ¾ÑÑ‚ Ñ Ñ‚Ğ²Ğ¾Ñ€Ğ¾Ğ³Ğ¾Ğ¼. ĞĞ±ĞµĞ´: Ğ¢Ñ€ĞµÑĞºĞ° + ĞšĞ°Ğ¿ÑƒÑÑ‚Ğ°. Ğ£Ğ¶Ğ¸Ğ½: Ğ¯Ğ¹Ñ†Ğ°.",
    17: "ğŸ Ğ”ĞµĞ½ÑŒ 17: ĞšĞ°ÑˆĞ° ÑÑ‡Ğ½ĞµĞ²Ğ°Ñ. ĞĞ±ĞµĞ´: Ğ¢ĞµÑ„Ñ‚ĞµĞ»Ğ¸ + Ğ‘ÑƒĞ»Ğ³ÑƒÑ€. Ğ£Ğ¶Ğ¸Ğ½: Ğ¢Ğ²Ğ¾Ñ€Ğ¾Ğ³.",
    18: "ğŸ Ğ”ĞµĞ½ÑŒ 18: ĞŸĞŸ Ğ¿ĞµÑ‡ĞµĞ½ÑŒĞµ. ĞĞ±ĞµĞ´: ĞŸĞ¾ÑÑ‚Ğ½Ñ‹Ğ¹ Ğ±Ğ¾Ñ€Ñ‰. Ğ£Ğ¶Ğ¸Ğ½: Ğ ÑĞ¶ĞµĞ½ĞºĞ°.",
    19: "ğŸ Ğ”ĞµĞ½ÑŒ 19: Ğ¡Ñ‹Ñ€Ğ½Ğ¸ĞºĞ¸. ĞĞ±ĞµĞ´: Ğ˜Ğ½Ğ´ĞµĞ¹ĞºĞ° + ĞšĞ¸Ğ½Ğ¾Ğ°. Ğ£Ğ¶Ğ¸Ğ½: Ğ¢Ğ²Ğ¾Ñ€Ğ¾Ğ³.",
    20: "ğŸ Ğ”ĞµĞ½ÑŒ 20: ĞĞ¼Ğ»ĞµÑ‚ ÑˆĞ¿Ğ¸Ğ½Ğ°Ñ‚. ĞĞ±ĞµĞ´: Ğ Ñ‹Ğ±Ğ½Ñ‹Ğµ ĞºĞ¾Ñ‚Ğ»ĞµÑ‚Ñ‹. Ğ£Ğ¶Ğ¸Ğ½: ĞĞ²Ğ¾Ñ‰Ğ¸.",
    21: "ğŸ Ğ”ĞµĞ½ÑŒ 21: ĞšĞ°ÑˆĞ° ĞºÑƒĞºÑƒÑ€ÑƒĞ·Ğ½Ğ°Ñ. ĞĞ±ĞµĞ´: Ğ¡Ñ‚ĞµĞ¹Ğº Ğ³Ğ¾Ğ²ÑĞ¶Ğ¸Ğ¹. Ğ£Ğ¶Ğ¸Ğ½: Ğ¢Ğ²Ğ¾Ñ€Ğ¾Ğ³.",
    22: "ğŸ Ğ”ĞµĞ½ÑŒ 22: Ğ Ğ¸Ñ Ñ ĞºÑƒÑ€Ğ°Ğ³Ğ¾Ğ¹. ĞĞ±ĞµĞ´: Ğ§ĞµÑ‡ĞµĞ²Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ÑÑƒĞ¿. Ğ£Ğ¶Ğ¸Ğ½: ĞœĞ¸Ğ½Ñ‚Ğ°Ğ¹.",
    23: "ğŸ Ğ”ĞµĞ½ÑŒ 23: ĞÑ€Ğ°Ñ…Ğ¸ÑĞ¾Ğ²Ğ°Ñ Ğ¿Ğ°ÑÑ‚Ğ°. ĞĞ±ĞµĞ´: ĞšÑƒÑ€Ğ¸Ñ†Ğ° + ĞĞ²Ğ¾Ñ‰Ğ¸. Ğ£Ğ¶Ğ¸Ğ½: Ğ¡Ğ°Ğ»Ğ°Ñ‚.",
    24: "ğŸ Ğ”ĞµĞ½ÑŒ 24: Ğ¯Ğ¸Ñ‡Ğ½Ğ¸Ñ†Ğ° Ğ²ĞµÑ‚Ñ‡Ğ¸Ğ½Ğ°. ĞĞ±ĞµĞ´: ĞŸĞ°ÑÑ‚Ğ° Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ½Ğ°Ñ. Ğ£Ğ¶Ğ¸Ğ½: Ğ ÑĞ¶ĞµĞ½ĞºĞ°.",
    25: "ğŸ Ğ”ĞµĞ½ÑŒ 25: Ğ¯Ğ±Ğ»Ğ¾ĞºĞ¾ Ğ¿ĞµÑ‡ĞµĞ½Ğ¾Ğµ. ĞĞ±ĞµĞ´: ĞŸĞ»Ğ¾Ğ² Ñ Ğ¼ÑÑĞ¾Ğ¼. Ğ£Ğ¶Ğ¸Ğ½: Ğ¢Ğ²Ğ¾Ñ€Ğ¾Ğ³.",
    26: "ğŸ Ğ”ĞµĞ½ÑŒ 26: Ğ¢Ğ²Ğ¾Ñ€Ğ¾Ğ³ Ğ¸ Ñ„ÑƒĞ½Ğ´ÑƒĞº. ĞĞ±ĞµĞ´: Ğ£Ñ…Ğ° ĞºÑ€Ğ°ÑĞ½Ğ°Ñ. Ğ£Ğ¶Ğ¸Ğ½: Ğ“Ñ€ÑƒĞ´ĞºĞ°.",
    27: "ğŸ Ğ”ĞµĞ½ÑŒ 27: ĞŸĞµÑ€Ğ»Ğ¾Ğ²ĞºĞ°. ĞĞ±ĞµĞ´: Ğ¢ÑƒÑˆĞµĞ½Ğ°Ñ ĞºĞ°Ğ¿ÑƒÑÑ‚Ğ°. Ğ£Ğ¶Ğ¸Ğ½: Ğ ÑĞ¶ĞµĞ½ĞºĞ°.",
    28: "ğŸ Ğ”ĞµĞ½ÑŒ 28: Ğ¤Ñ€ÑƒĞºÑ‚Ñ‹. ĞĞ±ĞµĞ´: Ğ Ğ¸Ñ + ĞÑƒÑ‚. Ğ£Ğ¶Ğ¸Ğ½: Ğ¡Ğ°Ğ»Ğ°Ñ‚ ÑĞ¸Ñ‡Ğ½Ñ‹Ğ¹.",
    29: "ğŸ Ğ”ĞµĞ½ÑŒ 29: Ğ¡Ñ‹Ñ€Ğ½Ğ¸ĞºĞ¸. ĞĞ±ĞµĞ´: Ğ Ñ‹Ğ±Ğ½Ñ‹Ğ¹ Ğ¿Ğ¸Ñ€Ğ¾Ğ³ ĞŸĞŸ. Ğ£Ğ¶Ğ¸Ğ½: ĞšĞµÑ„Ğ¸Ñ€.",
    30: "ğŸ Ğ”ĞµĞ½ÑŒ 30: Ğ“Ñ€ÑƒĞ´ĞºĞ° + Ğ Ğ¸Ñ + Ğ—ĞµĞ»ĞµĞ½ÑŒ. Ğ£Ğ¶Ğ¸Ğ½: Ğ¢Ğ²Ğ¾Ñ€Ğ¾Ğ³ 2%."
}

# --- ĞŸĞ Ğ Ğ¢Ğ Ğ•ĞĞ˜Ğ ĞĞ’ĞšĞ˜ (50 Ğ”ĞĞ•Ğ™) ---
PRO_WORK = {
    1: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 1: 50 Ğ¿Ñ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ğ¹, 30 Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹, 2 Ğ¼Ğ¸Ğ½ Ğ¿Ğ»Ğ°Ğ½ĞºĞ¸.",
    2: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 2: 40 Ğ²Ñ‹Ğ¿Ğ°Ğ´Ğ¾Ğ², 20 Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ñ‹Ñ… Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹, 50 Ğ¿Ñ€ĞµÑÑ.",
    3: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 3: ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ñ…Ğ¾Ğ´ÑŒĞ±Ğ° 5ĞºĞ¼ + Ñ€Ğ°ÑÑ‚ÑĞ¶ĞºĞ°.",
    4: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 4: 5 ĞºÑ€ÑƒĞ³Ğ¾Ğ²: 15 Ğ¿Ñ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ğ¹, 15 Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹, 30 ÑĞµĞº ÑĞºĞ°Ğ»Ğ¾Ğ»Ğ°Ğ·.",
    5: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 5: ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ğ»Ğ°Ğ½ĞºĞ° (3 Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´Ğ°) + 40 Ğ±ĞµÑ€Ğ¿Ğ¸.",
    6: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 6: ĞšÑ€ÑƒĞ³Ğ¾Ğ²Ğ°Ñ: Ğ²Ñ‹Ğ¿Ñ€Ñ‹Ğ³Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ (20), Ğ°Ğ»Ğ¼Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ (10) - 4 ĞºÑ€ÑƒĞ³Ğ°.",
    7: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 7: ĞŸĞĞ›ĞĞ«Ğ™ ĞĞ¢Ğ”Ğ«Ğ¥.",
    8: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 8: 20 ÑˆĞ¸Ñ€Ğ¾ĞºĞ¸Ñ… Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹, 30 ÑĞ³Ğ¾Ğ´Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ¼Ğ¾ÑÑ‚Ğ¸Ğº, 20 Ğ¿Ğ¾Ğ´ÑŠĞµĞ¼Ğ¾Ğ² Ğ½Ğ¾Ğ³.",
    9: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 9: 10 Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ±ĞµĞ³Ğ° Ğ½Ğ° Ğ¼ĞµÑÑ‚Ğµ + 50 Ğ´Ğ¶Ğ°Ğ¼Ğ¿Ğ¸Ğ½Ğ³-Ğ´Ğ¶ĞµĞºĞ¾Ğ².",
    10: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 10: Ğ¡Ñ‚ÑƒĞ»ÑŒÑ‡Ğ¸Ğº Ñƒ ÑÑ‚ĞµĞ½Ñ‹ 3Ñ…45 ÑĞµĞº + 30 Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹.",
    11: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 11: 4 ĞºÑ€ÑƒĞ³Ğ°: 20 Ğ²Ñ‹Ğ¿Ğ°Ğ´Ğ¾Ğ², 15 Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ñ‹Ñ… Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹, 20 Ğ¿Ñ€ĞµÑÑ.",
    12: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 12: Ğ‘Ğ¾ĞºĞ¾Ğ²Ğ°Ñ Ğ¿Ğ»Ğ°Ğ½ĞºĞ° Ğ¿Ğ¾ 1 Ğ¼Ğ¸Ğ½ Ğ½Ğ° ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ñƒ + 50 Ğ¿Ñ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ğ¹.",
    13: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 13: 50 Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹ (Ğ·Ğ° Ğ¼Ğ°ĞºÑ Ğ²Ñ€ĞµĞ¼Ñ) + 100 ÑĞºÑ€ÑƒÑ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğ¹.",
    14: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 14: Ğ Ğ°ÑÑ‚ÑĞ¶ĞºĞ° Ğ²ÑĞµĞ³Ğ¾ Ñ‚ĞµĞ»Ğ° 20 Ğ¼Ğ¸Ğ½ÑƒÑ‚.",
    15: "ğŸ’ª Ğ”ĞµĞ½ÑŒ 15: Ğ¢Ğ•Ğ¡Ğ¢: ĞŸÑ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ñ (Ğ¼Ğ°ĞºÑ), ĞÑ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ (Ğ¼Ğ°ĞºÑ).",
    16: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 16: Ğ’Ğ·Ñ€Ñ‹Ğ²Ğ½Ñ‹Ğµ Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ 4Ñ…10 + Ğ¿Ñ€Ñ‹Ğ¶ĞºĞ¸ Ğ¸Ğ· Ğ¿Ñ€Ğ¸ÑĞµĞ´Ğ° 4Ñ…15.",
    17: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 17: V-Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ´ÑŠĞµĞ¼Ñ‹ Ğ½Ğ° Ğ¿Ñ€ĞµÑÑ 3Ñ…15 + Ğ¿Ğ»Ğ°Ğ½ĞºĞ° 2 Ğ¼Ğ¸Ğ½.",
    18: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 18: ĞŸÑ€Ğ¾Ğ³ÑƒĞ»ĞºĞ° Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¼ ÑˆĞ°Ğ³Ğ¾Ğ¼ 40 Ğ¼Ğ¸Ğ½ÑƒÑ‚.",
    19: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 19: 5 ĞºÑ€ÑƒĞ³Ğ¾Ğ²: 10 Ğ±ĞµÑ€Ğ¿Ğ¸ + 20 Ğ²Ñ‹Ğ¿Ğ°Ğ´Ğ¾Ğ² + 15 ÑƒĞ·ĞºĞ¸Ñ… Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹.",
    20: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 20: Ğ‘Ğ¾Ğ»Ğ³Ğ°Ñ€ÑĞºĞ¸Ğµ Ğ²Ñ‹Ğ¿Ğ°Ğ´Ñ‹ 4Ñ…12 + ÑÑƒĞ¿ĞµÑ€Ğ¼ĞµĞ½ 4Ñ…15.",
    21: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 21: Ğ˜Ğ½Ğ´Ğ¸Ğ¹ÑĞºĞ¸Ğµ Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ 3Ñ…12 + Ñ€ÑƒÑÑĞºĞ¸Ğ¹ Ñ‚Ğ²Ğ¸ÑÑ‚ 3Ñ…40.",
    22: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 22: 6 ĞºÑ€ÑƒĞ³Ğ¾Ğ²: 30 Ğ¿Ñ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ğ¹, 20 Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹, 20 ÑĞµĞº Ğ±ĞµĞ³ Ğ½Ğ° Ğ¼ĞµÑÑ‚Ğµ.",
    23: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 23: Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ĞºĞ°: Ğ¡Ñ‚ÑƒĞ»ÑŒÑ‡Ğ¸Ğº 1 Ğ¼Ğ¸Ğ½ + ĞŸĞ»Ğ°Ğ½ĞºĞ° 1 Ğ¼Ğ¸Ğ½ + Ğ›Ğ¾Ğ´Ğ¾Ñ‡ĞºĞ° 1 Ğ¼Ğ¸Ğ½ (3 ÑĞµÑ‚Ğ°).",
    24: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 24: Ğ¡ĞºĞ°Ğ»Ğ¾Ğ»Ğ°Ğ· 4Ñ…1 Ğ¼Ğ¸Ğ½ + Ğ‘ĞµÑ€Ğ¿Ğ¸ 4Ñ…10.",
    25: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 25: Ğ­ĞšĞ’ĞĞ¢ĞĞ : 100 Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹ Ğ¸ 200 Ğ¿Ñ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ğ¹ Ğ·Ğ° Ğ´ĞµĞ½ÑŒ.",
    26: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 26: ĞÑ‚Ğ´Ñ‹Ñ… + Ğ»ĞµĞ³ĞºĞ°Ñ Ñ€Ğ°ÑÑ‚ÑĞ¶ĞºĞ°.",
    27: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 27: ĞĞ»Ğ¼Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ 4Ñ…15 + Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ñ‹Ğµ Ğ²Ñ‹Ğ¿Ğ°Ğ´Ñ‹ 4Ñ…20.",
    28: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 28: ĞŸĞ»Ğ°Ğ½ĞºĞ° Ñ Ğ¿Ñ€Ñ‹Ğ¶ĞºĞ¾Ğ¼ 3Ñ…20 + Ğ¿Ğ¾Ğ´ÑŠĞµĞ¼ Ğ½Ğ¾Ğ³ Ğ»ĞµĞ¶Ğ° 3Ñ…20.",
    29: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 29: Ğ¢Ğ°Ğ±Ğ°Ñ‚Ğ°: ĞŸÑ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ñ (20 ÑĞµĞº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ° / 10 ÑĞµĞº Ğ¾Ñ‚Ğ´Ñ‹Ñ…).",
    30: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 30: Ğ¢Ğ°Ğ±Ğ°Ñ‚Ğ°: ĞÑ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ.",
    31: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 31: Ğ’Ñ‹Ğ¿Ğ°Ğ´Ñ‹ Ğ² Ğ¿Ñ€Ñ‹Ğ¶ĞºĞµ 3Ñ…20 + Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ Ğ½Ğ° ĞºÑƒĞ»Ğ°ĞºĞ°Ñ… 3Ñ…15.",
    32: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 32: ĞŸÑ€ĞµÑÑ: ĞĞ¾Ğ¶Ğ½Ğ¸Ñ†Ñ‹ 1 Ğ¼Ğ¸Ğ½ + Ğ’ĞµĞ»Ğ¾ÑĞ¸Ğ¿ĞµĞ´ 1 Ğ¼Ğ¸Ğ½ + ĞŸĞ»Ğ°Ğ½ĞºĞ° 1 Ğ¼Ğ¸Ğ½.",
    33: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 33: Ğ—Ğ°Ğ±ĞµĞ³ Ğ¿Ğ¾ Ğ»ĞµÑÑ‚Ğ½Ğ¸Ñ†Ğµ 10 Ğ¼Ğ¸Ğ½ + Ñ€Ğ°ÑÑ‚ÑĞ¶ĞºĞ°.",
    34: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 34: 5 ÑĞµÑ‚Ğ¾Ğ²: 15 ÑˆĞ¸Ñ€Ğ¾ĞºĞ¸Ñ… Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹ + 15 Ğ²Ñ‹Ğ¿Ñ€Ñ‹Ğ³Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğ¹.",
    35: "ğŸ”¥ Ğ”ĞµĞ½ÑŒ 35: ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ Ğ±ĞµÑ€Ğ¿Ğ¸ Ğ·Ğ° 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚.",
    36: "ğŸš€ Ğ”ĞµĞ½ÑŒ 36: Ğ¡Ğ£ĞŸĞ•Ğ Ğ¡Ğ•Ğ¢: ĞÑ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ (Ğ¼Ğ°ĞºÑ) + ĞŸÑ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ñ (Ğ¼Ğ°ĞºÑ) - 4 ĞºÑ€ÑƒĞ³Ğ°.",
    37: "ğŸš€ Ğ”ĞµĞ½ÑŒ 37: 100 ÑĞºÑ€ÑƒÑ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğ¹ + 50 Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ñ‹Ñ… Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹.",
    38: "ğŸš€ Ğ”ĞµĞ½ÑŒ 38: ĞŸĞ»Ğ°Ğ½ĞºĞ° 'Ğ¿Ğ°ÑƒĞº' 4Ñ…20 + Ğ±Ğ¾ĞºĞ¾Ğ²Ñ‹Ğµ Ğ²Ñ‹Ğ¿Ğ°Ğ´Ñ‹ 4Ñ…20.",
    39: "ğŸš€ Ğ”ĞµĞ½ÑŒ 39: ĞŸĞĞ›ĞĞ«Ğ™ ĞĞ¢Ğ”Ğ«Ğ¥.",
    40: "ğŸš€ Ğ”ĞµĞ½ÑŒ 40: 10 ĞºÑ€ÑƒĞ³Ğ¾Ğ²: 5 Ğ±ĞµÑ€Ğ¿Ğ¸, 10 Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹, 15 Ğ¿Ñ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ğ¹.",
    41: "ğŸš€ Ğ”ĞµĞ½ÑŒ 41: Ğ¡ĞµÑ‚ Ğ½Ğ° Ğ¿Ñ€ĞµÑÑ: ĞŸĞ¾Ğ´ÑŠĞµĞ¼ Ğ½Ğ¾Ğ³ + Ğ¢Ğ²Ğ¸ÑÑ‚ + ĞŸĞ»Ğ°Ğ½ĞºĞ° (4 ĞºÑ€ÑƒĞ³Ğ°).",
    42: "ğŸš€ Ğ”ĞµĞ½ÑŒ 42: ĞŸÑ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ»Ğ¸Ğµ 4Ñ…30 + Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğµ Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ 4Ñ…15.",
    43: "ğŸš€ Ğ”ĞµĞ½ÑŒ 43: Ğ˜Ğ½Ñ‚ĞµĞ½ÑĞ¸Ğ²Ğ½Ğ¾Ğµ ĞºĞ°Ñ€Ğ´Ğ¸Ğ¾ 30 Ğ¼Ğ¸Ğ½ (Ğ±ĞµĞ³ Ğ¸Ğ»Ğ¸ Ğ¿Ñ€Ñ‹Ğ¶ĞºĞ¸).",
    44: "ğŸš€ Ğ”ĞµĞ½ÑŒ 44: 'Ğ›ĞµÑĞµĞ½ĞºĞ°' Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹: Ğ¾Ñ‚ 1 Ğ´Ğ¾ 10 Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ¾.",
    45: "ğŸš€ Ğ”ĞµĞ½ÑŒ 45: Ğ¡Ñ‚ÑƒĞ»ÑŒÑ‡Ğ¸Ğº Ñƒ ÑÑ‚ĞµĞ½Ñ‹ (Ğ¼Ğ°ĞºÑ Ğ²Ñ€ĞµĞ¼Ñ) + Ğ¡ÑƒĞ¿ĞµÑ€Ğ¼ĞµĞ½ 4Ñ…20.",
    46: "ğŸš€ Ğ”ĞµĞ½ÑŒ 46: 50 Ğ²Ñ‹Ğ¿Ñ€Ñ‹Ğ³Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğ¹ + 50 Ğ°Ğ»Ğ¼Ğ°Ğ·Ğ½Ñ‹Ñ… Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹.",
    47: "ğŸš€ Ğ”ĞµĞ½ÑŒ 47: ĞŸĞ»Ğ°Ğ½ĞºĞ° Ğ½Ğ° Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ñ€ÑƒĞºĞµ (Ğ¿Ğ¾ 30 ÑĞµĞº) + Ğ¡ĞºĞ°Ğ»Ğ¾Ğ»Ğ°Ğ· (2 Ğ¼Ğ¸Ğ½).",
    48: "ğŸš€ Ğ”ĞµĞ½ÑŒ 48: 100 Ğ²Ñ‹Ğ¿Ğ°Ğ´Ğ¾Ğ² + 100 Ğ¿Ğ¾Ğ´ÑŠĞµĞ¼Ğ¾Ğ² Ğ½Ğ° Ğ½Ğ¾ÑĞºĞ¸.",
    49: "ğŸš€ Ğ”ĞµĞ½ÑŒ 49: Ğ Ğ°ÑÑ‚ÑĞ¶ĞºĞ° Ğ²ÑĞµĞ³Ğ¾ Ñ‚ĞµĞ»Ğ°.",
    50: "ğŸ† Ğ”ĞµĞ½ÑŒ 50: Ğ¤Ğ˜ĞĞĞ›: 100 Ğ¾Ñ‚Ğ¶Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¹, 100 Ğ¿Ñ€ĞµÑÑĞ°, 100 Ğ¿Ñ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ğ¹, 5 Ğ¼Ğ¸Ğ½ Ğ¿Ğ»Ğ°Ğ½ĞºĞ¸!"
}

# --- Ğ¤Ğ£ĞĞšĞ¦Ğ˜Ğ˜ ---
def pre_generate_voices():
    print("ğŸ™ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¾Ğ·Ğ²ÑƒÑ‡ĞºĞ¸...")
    for cat in WORKOUTS:
        for ex in WORKOUTS[cat]:
            safe_name = "".join([c for c in ex['name'] if c.isalnum()])
            path = f"voice_cache/{safe_name}.mp3"
            if not os.path.exists(path):
                try: gTTS(text=f"{ex['name']}. Ğ¦ĞµĞ»ÑŒ {ex['reps']}", lang='ru').save(path)
                except: pass

def init_user(uid):
    if uid not in user_data:
        user_data[uid] = {'plan': [], 'idx': 0, 'theme': 'dark'}
    return user_data[uid]

def get_main_kb():
    m = types.ReplyKeyboardMarkup(resize_keyboard=True)
    m.add("Ğ’Ğ•Ğ Ğ¥ Ğ¢Ğ•Ğ›Ğ", "ĞĞĞ“Ğ˜ Ğ˜ Ğ¯Ğ“ĞĞ”Ğ˜Ğ¦Ğ«")
    m.add("ğŸ”¥ ĞŸĞ Ğ•ĞœĞ†Ğ£Ğœ ĞšĞ£Ğ Ğ¡ (120 Ğ³Ñ€Ğ½)")
    m.add("ğŸ¥— Ğ“ĞĞ™Ğ” ĞŸĞ ĞŸĞ˜Ğ¢ĞĞĞ˜Ğ®", "ğŸŒ“ Ğ¡Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ñ‚ĞµĞ¼Ñƒ")
    return m

# --- ĞĞ‘Ğ ĞĞ‘ĞĞ¢Ğ§Ğ˜ĞšĞ˜ ---
@bot.message_handler(commands=['start'])
def start(message):
    uid = message.from_user.id
    with db_lock:
        cursor.execute('INSERT OR IGNORE INTO users (user_id, username, first_name) VALUES (?, ?, ?)', 
                       (uid, message.from_user.username, message.from_user.first_name))
        conn.commit()
    init_user(uid)
    bot.send_message(message.chat.id, "ğŸš€ Ğ‘Ğ¾Ñ‚ GYM PRO Ğ·Ğ°Ñ‰Ğ¸Ñ‰ĞµĞ½ Ğ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ²!", reply_markup=get_main_kb())

def send_exercise(chat_id, uid):
    data = user_data.get(uid)
    if not data or data['idx'] >= len(data['plan']):
        bot.send_message(chat_id, "ğŸ‰ Ğ¢Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¾ĞºĞ¾Ğ½Ñ‡ĞµĞ½Ğ°!", reply_markup=get_main_kb())
        return
    ex = data['plan'][data['idx']]
    
    def handle_voice():
        safe_name = "".join([c for c in ex['name'] if c.isalnum()])
        path = f"voice_cache/{safe_name}.mp3"
        if os.path.exists(path):
            with open(path, 'rb') as v: bot.send_voice(chat_id, v)

    Thread(target=handle_voice).start()
    header = "ğŸŒ‘ [DARK]" if data['theme'] == 'dark' else "â˜€ï¸ [LIGHT]"
    caption = f"{header}\n\nğŸ”¥ *{ex['name']}*\nğŸ¯ {ex['reps']}\n\nğŸ“ {ex['desc']}"
    markup = types.InlineKeyboardMarkup()
    markup.add(types.InlineKeyboardButton("âœ… Ğ”ĞĞ›Ğ¬Ğ¨Ğ•", callback_data="next_step"))
    bot.send_message(chat_id, caption, parse_mode="Markdown", reply_markup=markup)

@bot.callback_query_handler(func=lambda call: call.data == "next_step")
def next_step(call):
    uid = call.from_user.id
    if uid in user_data:
        user_data[uid]['idx'] += 1
        try: bot.delete_message(call.message.chat.id, call.message.message_id)
        except: pass
        send_exercise(call.message.chat.id, uid)

@bot.message_handler(func=lambda message: message.text == "ğŸ”¥ ĞŸĞ Ğ•ĞœĞ†Ğ£Ğœ ĞšĞ£Ğ Ğ¡ (120 Ğ³Ñ€Ğ½)")
def premium_menu(message):
    uid = message.from_user.id
    with sqlite3.connect('gym_pro_users.db') as c:
        res = c.execute('SELECT is_premium FROM users WHERE user_id = ?', (uid,)).fetchone()
    
    if res and res[0] == 1:
        markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
        markup.add("ğŸƒâ€â™‚ï¸ Ğ¢Ğ Ğ•ĞĞ£Ğ’ĞĞĞĞ¯ (50 Ğ”ĞĞ†Ğ’)", "ğŸ Ğ¥ĞĞ Ğ§Ğ£Ğ’ĞĞĞĞ¯ (30 Ğ”ĞĞ†Ğ’)", "â¬…ï¸ ĞĞĞ—ĞĞ”")
        bot.send_message(message.chat.id, "ğŸŒŸ **Ğ’Ğ°Ñˆ ĞŸÑ€ĞµĞ¼Ñ–ÑƒĞ¼-ĞºĞ°Ğ±Ñ–Ğ½ĞµÑ‚!**", reply_markup=markup, parse_mode="Markdown")
    else:
        info_text = (
            "ğŸš€ **ĞŸĞ Ğ•ĞœĞ†Ğ£Ğœ ĞšĞ£Ğ Ğ¡: Ğ¢Ğ ĞĞĞ¡Ğ¤ĞĞ ĞœĞĞ¦Ğ†Ğ¯**\n\n"
            "ğŸ’³ **ĞĞ¿Ğ»Ğ°Ñ‚Ğ° Ğ½Ğ° ĞºĞ°Ñ€Ñ‚Ñƒ:**\n`4102321251250550`\n\n"
            "ğŸ“¸ **ĞŸĞ Ğ˜Ğ¨Ğ›Ğ˜Ğ¢Ğ• Ğ¡ĞšĞ Ğ˜ĞĞ¨ĞĞ¢ ĞĞŸĞ›ĞĞ¢Ğ« Ğ¡Ğ®Ğ”Ğ**\n"
            "Ğ’Ğ°Ñˆ ID: `{}`"
        ).format(uid)
        bot.send_message(message.chat.id, info_text, parse_mode="Markdown")

@bot.message_handler(content_types=['photo'])
def handle_payment(message):
    uid = message.from_user.id
    markup = types.InlineKeyboardMarkup()
    markup.add(types.InlineKeyboardButton("âœ… Ğ’Ğ«Ğ”ĞĞ¢Ğ¬ ĞŸĞ Ğ•Ğœ", callback_data=f"adm_give_{uid}"))
    bot.send_photo(ADMIN_ID, message.photo[-1].file_id, caption=f"ğŸ’° Ğ§Ğ•Ğš Ğ¾Ñ‚ {uid}", reply_markup=markup)
    bot.reply_to(message, "â³ Ğ§ĞµĞº Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½ Ğ½Ğ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºÑƒ!")

@bot.callback_query_handler(func=lambda call: call.data.startswith("adm_give_"))
def admin_action(call):
    if call.from_user.id != ADMIN_ID: return
    target_id = int(call.data.split("_")[2])
    with sqlite3.connect('gym_pro_users.db') as c:
        c.execute('UPDATE users SET is_premium = 1 WHERE user_id = ?', (target_id,))
    bot.send_message(target_id, "ğŸ‰ ĞŸĞ Ğ•ĞœĞ˜Ğ£Ğœ ĞĞšĞ¢Ğ˜Ğ’Ğ˜Ğ ĞĞ’ĞĞ!")
    bot.answer_callback_query(call.id, "Ğ’Ñ‹Ğ´Ğ°Ğ½Ğ¾!")

@bot.message_handler(func=lambda message: message.text == "ğŸƒâ€â™‚ï¸ Ğ¢Ğ Ğ•ĞĞ£Ğ’ĞĞĞĞ¯ (50 Ğ”ĞĞ†Ğ’)")
def prem_work(message):
    uid = message.from_user.id
    with sqlite3.connect('gym_pro_users.db') as c:
        res = c.execute('SELECT is_premium FROM users WHERE user_id = ?', (uid,)).fetchone()
    if res and res[0] == 1:
        for i in range(1, 51, 10):
            chunk = "\n\n".join([PRO_WORK[j] for j in range(i, min(i+10, 51))])
            bot.send_message(message.chat.id, chunk)
            time.sleep(0.3)
    else: bot.send_message(message.chat.id, "ğŸ”’ Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚.")

@bot.message_handler(func=lambda message: message.text == "ğŸ Ğ¥ĞĞ Ğ§Ğ£Ğ’ĞĞĞĞ¯ (30 Ğ”ĞĞ†Ğ’)")
def prem_nutr(message):
    uid = message.from_user.id
    with sqlite3.connect('gym_pro_users.db') as c:
        res = c.execute('SELECT is_premium FROM users WHERE user_id = ?', (uid,)).fetchone()
    if res and res[0] == 1:
        for i in range(1, 31, 10):
            chunk = "\n\n".join([PRO_DIET[j] for j in range(i, min(i+10, 31))])
            bot.send_message(message.chat.id, chunk)
            time.sleep(0.3)
    else: bot.send_message(message.chat.id, "ğŸ”’ Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚.")

@bot.message_handler(func=lambda message: message.text in WORKOUTS.keys())
def start_w(message):
    uid = message.from_user.id
    d = init_user(uid)
    d['plan'], d['idx'] = WORKOUTS[message.text], 0
    send_exercise(message.chat.id, uid)

@bot.message_handler(func=lambda message: message.text == "ğŸŒ“ Ğ¡Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ñ‚ĞµĞ¼Ñƒ")
def theme(message):
    d = init_user(message.from_user.id)
    d['theme'] = 'light' if d['theme'] == 'dark' else 'dark'
    bot.reply_to(message, "âœ… Ğ¢ĞµĞ¼Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ°!")

@bot.message_handler(func=lambda message: message.text == "â¬…ï¸ ĞĞĞ—ĞĞ”")
def back(message): start(message)

if __name__ == "__main__":
    pre_generate_voices()
    print("ğŸš€ Ğ‘ĞĞ¢ Ğ—ĞĞŸĞ£Ğ©Ğ•Ğ Ğ˜ Ğ—ĞĞ©Ğ˜Ğ©Ğ•Ğ!")
    bot.polling(none_stop=True)